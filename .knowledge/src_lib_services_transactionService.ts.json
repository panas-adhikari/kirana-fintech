{"is_source_file": true, "format": "TypeScript", "description": "This file contains service functions related to transactions, including adding a new transaction and retrieving transactions for a user, interacting with a Supabase backend.", "external_files": ["@/lib/supabase/server", "@/types", "next/cache"], "external_methods": ["createServerClient", "revalidatePath"], "published": ["addTransaction", "getTransactions"], "classes": [], "methods": [{"name": "export async function addTransaction(formData: TransactionInput) { addTransaction", "description": "Creates a new transaction record in the database using form data, associates it with the current user, and revalidates cache paths.", "scope": "", "scopeKind": ""}, {"name": "export async function getTransactions(): Promise<Transaction[]> { getTransactions", "description": "Fetches the list of transactions created by the current user, ordered by creation date.", "scope": "", "scopeKind": ""}], "calls": ["await createServerClient()", "supabase.auth.getUser()", "supabase.from('users').select('branch:branches(store_id)').eq('id', user.id).single()", "supabase.from('transactions').insert(...)", "supabase.from('transactions').select('*').eq('created_by', user.id).order('created_at', { ascending: false })", "revalidatePath('/dashboard/transactions')", "revalidatePath('/dashboard')"], "search-terms": ["transactionService.ts", "addTransaction", "getTransactions", "Supabase", "transaction"], "state": 2, "file_id": 57, "knowledge_revision": 216, "git_revision": "407fc76aca9d4e2629877b12781490020c6f85a2", "ctags": [{"_type": "tag", "name": "addTransaction", "path": "/home/kavia/workspace/code-generation/kirana-fintech/src/lib/services/transactionService.ts", "pattern": "/^export async function addTransaction(formData: TransactionInput) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "currency", "path": "/home/kavia/workspace/code-generation/kirana-fintech/src/lib/services/transactionService.ts", "pattern": "/^        currency: 'NPR',$/", "language": "TypeScript", "kind": "constant", "scope": "addTransaction", "scopeKind": "function"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/kirana-fintech/src/lib/services/transactionService.ts", "pattern": "/^    const { data, error } = await supabase$/", "language": "TypeScript", "kind": "constant", "scope": "addTransaction", "scopeKind": "function"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/kirana-fintech/src/lib/services/transactionService.ts", "pattern": "/^    const { data, error } = await supabase$/", "language": "TypeScript", "kind": "constant", "scope": "getTransactions", "scopeKind": "function"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/kirana-fintech/src/lib/services/transactionService.ts", "pattern": "/^    const { data: userData, error: userError } = await supabase$/", "language": "TypeScript", "kind": "constant", "scope": "addTransaction", "scopeKind": "function"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/kirana-fintech/src/lib/services/transactionService.ts", "pattern": "/^    const { data: { user } } = await supabase.auth.getUser();$/", "language": "TypeScript", "kind": "constant", "scope": "addTransaction", "scopeKind": "function"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/kirana-fintech/src/lib/services/transactionService.ts", "pattern": "/^    const { data: { user } } = await supabase.auth.getUser();$/", "language": "TypeScript", "kind": "constant", "scope": "getTransactions", "scopeKind": "function"}, {"_type": "tag", "name": "error", "path": "/home/kavia/workspace/code-generation/kirana-fintech/src/lib/services/transactionService.ts", "pattern": "/^    const { data, error } = await supabase$/", "language": "TypeScript", "kind": "constant", "scope": "addTransaction", "scopeKind": "function"}, {"_type": "tag", "name": "error", "path": "/home/kavia/workspace/code-generation/kirana-fintech/src/lib/services/transactionService.ts", "pattern": "/^    const { data, error } = await supabase$/", "language": "TypeScript", "kind": "constant", "scope": "getTransactions", "scopeKind": "function"}, {"_type": "tag", "name": "error", "path": "/home/kavia/workspace/code-generation/kirana-fintech/src/lib/services/transactionService.ts", "pattern": "/^    const { data: userData, error: userError } = await supabase$/", "language": "TypeScript", "kind": "constant", "scope": "addTransaction", "scopeKind": "function"}, {"_type": "tag", "name": "getTransactions", "path": "/home/kavia/workspace/code-generation/kirana-fintech/src/lib/services/transactionService.ts", "pattern": "/^export async function getTransactions(): Promise<Transaction[]> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "storeId", "path": "/home/kavia/workspace/code-generation/kirana-fintech/src/lib/services/transactionService.ts", "pattern": "/^    const storeId = (userData?.branch as any)?.store_id;$/", "language": "TypeScript", "kind": "constant", "scope": "addTransaction", "scopeKind": "function"}, {"_type": "tag", "name": "supabase", "path": "/home/kavia/workspace/code-generation/kirana-fintech/src/lib/services/transactionService.ts", "pattern": "/^    const supabase = await createServerClient();$/", "language": "TypeScript", "kind": "constant", "scope": "addTransaction", "scopeKind": "function"}, {"_type": "tag", "name": "supabase", "path": "/home/kavia/workspace/code-generation/kirana-fintech/src/lib/services/transactionService.ts", "pattern": "/^    const supabase = await createServerClient();$/", "language": "TypeScript", "kind": "constant", "scope": "getTransactions", "scopeKind": "function"}, {"_type": "tag", "name": "totalAmount", "path": "/home/kavia/workspace/code-generation/kirana-fintech/src/lib/services/transactionService.ts", "pattern": "/^    const totalAmount = formData.items.reduce((sum, item) => sum + (item.quantity * item.unit_pr/", "language": "TypeScript", "kind": "constant", "scope": "addTransaction", "scopeKind": "function"}, {"_type": "tag", "name": "transactionToInsert", "path": "/home/kavia/workspace/code-generation/kirana-fintech/src/lib/services/transactionService.ts", "pattern": "/^    const transactionToInsert = {$/", "language": "TypeScript", "kind": "constant", "scope": "addTransaction", "scopeKind": "function"}], "hash": "2d3e4a2f9e194c4b525ac5fe1e12ab3c", "format-version": 4, "code-base-name": "kirana-fintech", "filename": "src/lib/services/transactionService.ts", "revision_history": [{"216": "407fc76aca9d4e2629877b12781490020c6f85a2"}]}